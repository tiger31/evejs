#!/usr/bin/env node
const Runner = require('../lib/classes/Runner');
const builder = require('@evecat/pages-reporter');

const argv = require('yargs')
	.options({
		d: {
			alias: 'directory',
			default: 'tests',
			describe: 'Directory with tests',
			type: 'string',
			group: 'Config'
		},
		p: {
			alias: ['pattern', 'glob'],
			default: '*.test.js',
			describe: 'Pattern of test file names',
			type: 'string',
			group: 'Config'
		},
		t: {
			alias: 'timeout',
			default: 2000,
			describe: 'Default tests timeout',
			type: 'number',
			group: 'Config'
		},
		s: {
			alias: 'scope',
			default: ['all'],
			describe: 'Runner filtering scope',
			type: 'array',
			group: 'Filter'
		},
		e: {
			alias: 'epic',
			describe: 'Epics to be run',
			type: 'array',
			group: 'Filter'
		},
		f: {
			alias: 'feature',
			describe: 'Features to be run',
			type: 'array',
			group: 'Filter'
		},
		story: {
			describe: 'Stories to be run',
			type: 'array',
			group: 'Filter'
		},
		r: {
			alias: 'reporter',
			describe: 'Reporter',
			default: 'default',
			group: 'Config'
		},
		include: {
			describe: "Files to be included before test files",
			default: [],
			type: 'array',
			group: 'Config'
		},
		'results-dir': {
			describe: "While using eve reporter sets output directory on runner json results",
			default: 'results',
			group: 'Report'
		},
		'report-dir': {
			describe: "While using eve reporter sets output directory for built report files",
			default: 'report',
			group: 'Report'
		}
	}).command('$0', "Run tests", () => {}, (args) => {
		(new Runner(args)).run();
	}).command('report', 'Build report from json results', () => {}, (args) => {
		const b = new builder(args);
		b.build();
	}).argv;


